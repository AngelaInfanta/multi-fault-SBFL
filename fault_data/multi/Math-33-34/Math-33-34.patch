diff --git a/defects4j.build.properties b/defects4j.build.properties
index 5fecfd4..e3ff5e6 100644
--- a/defects4j.build.properties
+++ b/defects4j.build.properties
@@ -1,5 +1,6 @@
 #File automatically generated by Defects4J
 d4j.bug.id=34
+d4j.classes.instrument=org/apache/commons/math3/analysis/BivariateFunction.class,org/apache/commons/math3/analysis/BivariateFunction\$*.class,org/apache/commons/math3/exception/DimensionMismatchException.class,org/apache/commons/math3/exception/DimensionMismatchException\$*.class,org/apache/commons/math3/exception/MathArithmeticException.class,org/apache/commons/math3/exception/MathArithmeticException\$*.class,org/apache/commons/math3/exception/MathIllegalArgumentException.class,org/apache/commons/math3/exception/MathIllegalArgumentException\$*.class,org/apache/commons/math3/exception/MathIllegalNumberException.class,org/apache/commons/math3/exception/MathIllegalNumberException\$*.class,org/apache/commons/math3/exception/MathIllegalStateException.class,org/apache/commons/math3/exception/MathIllegalStateException\$*.class,org/apache/commons/math3/exception/MathParseException.class,org/apache/commons/math3/exception/MathParseException\$*.class,org/apache/commons/math3/exception/MaxCountExceededException.class,org/apache/commons/math3/exception/MaxCountExceededException\$*.class,org/apache/commons/math3/exception/MultiDimensionMismatchException.class,org/apache/commons/math3/exception/MultiDimensionMismatchException\$*.class,org/apache/commons/math3/exception/NoDataException.class,org/apache/commons/math3/exception/NoDataException\$*.class,org/apache/commons/math3/exception/NotFiniteNumberException.class,org/apache/commons/math3/exception/NotFiniteNumberException\$*.class,org/apache/commons/math3/exception/NotPositiveException.class,org/apache/commons/math3/exception/NotPositiveException\$*.class,org/apache/commons/math3/exception/NotStrictlyPositiveException.class,org/apache/commons/math3/exception/NotStrictlyPositiveException\$*.class,org/apache/commons/math3/exception/NullArgumentException.class,org/apache/commons/math3/exception/NullArgumentException\$*.class,org/apache/commons/math3/exception/NumberIsTooLargeException.class,org/apache/commons/math3/exception/NumberIsTooLargeException\$*.class,org/apache/commons/math3/exception/NumberIsTooSmallException.class,org/apache/commons/math3/exception/NumberIsTooSmallException\$*.class,org/apache/commons/math3/exception/OutOfRangeException.class,org/apache/commons/math3/exception/OutOfRangeException\$*.class,org/apache/commons/math3/exception/ZeroException.class,org/apache/commons/math3/exception/ZeroException\$*.class,org/apache/commons/math3/exception/util/ExceptionContextProvider.class,org/apache/commons/math3/exception/util/ExceptionContextProvider\$*.class,org/apache/commons/math3/exception/util/Localizable.class,org/apache/commons/math3/exception/util/Localizable\$*.class,org/apache/commons/math3/genetics/AbstractListChromosome.class,org/apache/commons/math3/genetics/AbstractListChromosome\$*.class,org/apache/commons/math3/genetics/BinaryChromosome.class,org/apache/commons/math3/genetics/BinaryChromosome\$*.class,org/apache/commons/math3/genetics/Chromosome.class,org/apache/commons/math3/genetics/Chromosome\$*.class,org/apache/commons/math3/genetics/Fitness.class,org/apache/commons/math3/genetics/Fitness\$*.class,org/apache/commons/math3/genetics/GeneticAlgorithm.class,org/apache/commons/math3/genetics/GeneticAlgorithm\$*.class,org/apache/commons/math3/genetics/InvalidRepresentationException.class,org/apache/commons/math3/genetics/InvalidRepresentationException\$*.class,org/apache/commons/math3/genetics/ListPopulation.class,org/apache/commons/math3/genetics/ListPopulation\$*.class,org/apache/commons/math3/genetics/Population.class,org/apache/commons/math3/genetics/Population\$*.class,org/apache/commons/math3/linear/AbstractFieldMatrix.class,org/apache/commons/math3/linear/AbstractFieldMatrix\$*.class,org/apache/commons/math3/linear/AbstractRealMatrix.class,org/apache/commons/math3/linear/AbstractRealMatrix\$*.class,org/apache/commons/math3/linear/AnyMatrix.class,org/apache/commons/math3/linear/AnyMatrix\$*.class,org/apache/commons/math3/linear/Array2DRowFieldMatrix.class,org/apache/commons/math3/linear/Array2DRowFieldMatrix\$*.class,org/apache/commons/math3/linear/Array2DRowRealMatrix.class,org/apache/commons/math3/linear/Array2DRowRealMatrix\$*.class,org/apache/commons/math3/linear/ArrayRealVector.class,org/apache/commons/math3/linear/ArrayRealVector\$*.class,org/apache/commons/math3/linear/BlockFieldMatrix.class,org/apache/commons/math3/linear/BlockFieldMatrix\$*.class,org/apache/commons/math3/linear/BlockRealMatrix.class,org/apache/commons/math3/linear/BlockRealMatrix\$*.class,org/apache/commons/math3/linear/FieldMatrix.class,org/apache/commons/math3/linear/FieldMatrix\$*.class,org/apache/commons/math3/linear/FieldMatrixPreservingVisitor.class,org/apache/commons/math3/linear/FieldMatrixPreservingVisitor\$*.class,org/apache/commons/math3/linear/FieldVector.class,org/apache/commons/math3/linear/FieldVector\$*.class,org/apache/commons/math3/linear/MatrixDimensionMismatchException.class,org/apache/commons/math3/linear/MatrixDimensionMismatchException\$*.class,org/apache/commons/math3/linear/MatrixUtils.class,org/apache/commons/math3/linear/MatrixUtils\$*.class,org/apache/commons/math3/linear/NonSquareMatrixException.class,org/apache/commons/math3/linear/NonSquareMatrixException\$*.class,org/apache/commons/math3/linear/OpenMapRealMatrix.class,org/apache/commons/math3/linear/OpenMapRealMatrix\$*.class,org/apache/commons/math3/linear/RealLinearOperator.class,org/apache/commons/math3/linear/RealLinearOperator\$*.class,org/apache/commons/math3/linear/RealMatrix.class,org/apache/commons/math3/linear/RealMatrix\$*.class,org/apache/commons/math3/linear/RealMatrixChangingVisitor.class,org/apache/commons/math3/linear/RealMatrixChangingVisitor\$*.class,org/apache/commons/math3/linear/RealMatrixPreservingVisitor.class,org/apache/commons/math3/linear/RealMatrixPreservingVisitor\$*.class,org/apache/commons/math3/linear/RealVector.class,org/apache/commons/math3/linear/RealVector\$*.class,org/apache/commons/math3/linear/RealVectorFormat.class,org/apache/commons/math3/linear/RealVectorFormat\$*.class,org/apache/commons/math3/linear/SparseRealMatrix.class,org/apache/commons/math3/linear/SparseRealMatrix\$*.class,org/apache/commons/math3/optimization/GoalType.class,org/apache/commons/math3/optimization/GoalType\$*.class,org/apache/commons/math3/optimization/PointValuePair.class,org/apache/commons/math3/optimization/PointValuePair\$*.class,org/apache/commons/math3/optimization/linear/AbstractLinearOptimizer.class,org/apache/commons/math3/optimization/linear/AbstractLinearOptimizer\$*.class,org/apache/commons/math3/optimization/linear/LinearConstraint.class,org/apache/commons/math3/optimization/linear/LinearConstraint\$*.class,org/apache/commons/math3/optimization/linear/LinearObjectiveFunction.class,org/apache/commons/math3/optimization/linear/LinearObjectiveFunction\$*.class,org/apache/commons/math3/optimization/linear/LinearOptimizer.class,org/apache/commons/math3/optimization/linear/LinearOptimizer\$*.class,org/apache/commons/math3/optimization/linear/NoFeasibleSolutionException.class,org/apache/commons/math3/optimization/linear/NoFeasibleSolutionException\$*.class,org/apache/commons/math3/optimization/linear/Relationship.class,org/apache/commons/math3/optimization/linear/Relationship\$*.class,org/apache/commons/math3/optimization/linear/SimplexSolver.class,org/apache/commons/math3/optimization/linear/SimplexSolver\$*.class,org/apache/commons/math3/optimization/linear/SimplexTableau.class,org/apache/commons/math3/optimization/linear/SimplexTableau\$*.class,org/apache/commons/math3/optimization/linear/UnboundedSolutionException.class,org/apache/commons/math3/optimization/linear/UnboundedSolutionException\$*.class,org/apache/commons/math3/random/JDKRandomGenerator.class,org/apache/commons/math3/random/JDKRandomGenerator\$*.class,org/apache/commons/math3/random/RandomGenerator.class,org/apache/commons/math3/random/RandomGenerator\$*.class,org/apache/commons/math3/util/CompositeFormat.class,org/apache/commons/math3/util/CompositeFormat\$*.class,org/apache/commons/math3/util/FastMath.class,org/apache/commons/math3/util/FastMath\$*.class,org/apache/commons/math3/util/MathUtils.class,org/apache/commons/math3/util/MathUtils\$*.class,org/apache/commons/math3/util/Pair.class,org/apache/commons/math3/util/Pair\$*.class,org/apache/commons/math3/util/Precision.class,org/apache/commons/math3/util/Precision\$*.class
 d4j.classes.modified=org.apache.commons.math3.genetics.ListPopulation
 d4j.classes.relevant=org.apache.commons.math3.exception.MathIllegalArgumentException,org.apache.commons.math3.exception.MathIllegalNumberException,org.apache.commons.math3.exception.NotPositiveException,org.apache.commons.math3.exception.NullArgumentException,org.apache.commons.math3.exception.NumberIsTooLargeException,org.apache.commons.math3.exception.NumberIsTooSmallException,org.apache.commons.math3.exception.OutOfRangeException,org.apache.commons.math3.exception.util.ExceptionContextProvider,org.apache.commons.math3.exception.util.Localizable,org.apache.commons.math3.genetics.AbstractListChromosome,org.apache.commons.math3.genetics.BinaryChromosome,org.apache.commons.math3.genetics.Chromosome,org.apache.commons.math3.genetics.Fitness,org.apache.commons.math3.genetics.GeneticAlgorithm,org.apache.commons.math3.genetics.InvalidRepresentationException,org.apache.commons.math3.genetics.ListPopulation,org.apache.commons.math3.genetics.Population,org.apache.commons.math3.random.JDKRandomGenerator,org.apache.commons.math3.random.RandomGenerator
 d4j.dir.src.classes=src/main/java
diff --git a/src/test/java/org/apache/commons/math3/optimization/linear/SimplexSolverTest.java b/src/test/java/org/apache/commons/math3/optimization/linear/SimplexSolverTest.java
index 4b1a4b5..0336a49 100644
--- a/src/test/java/org/apache/commons/math3/optimization/linear/SimplexSolverTest.java
+++ b/src/test/java/org/apache/commons/math3/optimization/linear/SimplexSolverTest.java
@@ -540,5 +540,23 @@ public class SimplexSolverTest {
         }
         return new LinearConstraint(lhs, relationship, rhs);
     }
+    @Test
+    public void testMath781() {
+        LinearObjectiveFunction f = new LinearObjectiveFunction(new double[] { 2, 6, 7 }, 0);
+
+        ArrayList<LinearConstraint> constraints = new ArrayList<LinearConstraint>();
+        constraints.add(new LinearConstraint(new double[] { 1, 2, 1 }, Relationship.LEQ, 2));
+        constraints.add(new LinearConstraint(new double[] { -1, 1, 1 }, Relationship.LEQ, -1));
+        constraints.add(new LinearConstraint(new double[] { 2, -3, 1 }, Relationship.LEQ, -1));
+
+        double epsilon = 1e-6;
+        SimplexSolver solver = new SimplexSolver();
+        PointValuePair solution = solver.optimize(f, constraints, GoalType.MAXIMIZE, false);
+
+        Assert.assertTrue(Precision.compareTo(solution.getPoint()[0], 0.0d, epsilon) > 0);
+        Assert.assertTrue(Precision.compareTo(solution.getPoint()[1], 0.0d, epsilon) > 0);
+        Assert.assertTrue(Precision.compareTo(solution.getPoint()[2], 0.0d, epsilon) < 0);
+        Assert.assertEquals(2.0d, solution.getValue(), epsilon);
+    }
 
 }
